{
  "version": "1.0.2",
  "description": "Unified security and safety hooks for Supernova",
  "hooks": [
    {
      "id": "pre-write-security",
      "event": "PreToolUse",
      "matcher": "Write|Edit",
      "action": "guard:scan-file",
      "priority": 1,
      "enabled": true
    },
    {
      "id": "pre-execute-security",
      "event": "PreToolUse",
      "matcher": "Bash",
      "action": "guard:scan-command",
      "priority": 1,
      "enabled": true
    },
    {
      "id": "pre-delete-confirm",
      "event": "PreToolUse",
      "matcher": "Delete",
      "action": "guard:confirm-deletion",
      "priority": 1,
      "enabled": true
    },
    {
      "id": "post-write-verify",
      "event": "PostToolUse",
      "matcher": "Write|Edit",
      "action": "guard:verify-no-secrets",
      "priority": 2,
      "enabled": true
    }
  ],
  "scanners": {
    "secrets": {
      "enabled": true,
      "patterns": [
        "sk-[a-zA-Z0-9]{48}",
        "AKIA[0-9A-Z]{16}",
        "ghp_[a-zA-Z0-9]{36}",
        "xox[baprs]-[0-9a-zA-Z-]+",
        "sk_live_[0-9a-zA-Z]{24}",
        "sk_test_[0-9a-zA-Z]{24}",
        "-----BEGIN [A-Z ]+ PRIVATE KEY-----",
        "api[_-]?key[\"\\s]*[:=][\"\\s]*[a-zA-Z0-9]{16,}",
        "password[\"\\s]*[:=][\"\\s]*[^\"\\s']{8,}"
      ]
    },
    "injection": {
      "enabled": true,
      "patterns": [
        "ignore previous instructions",
        "ignore the above",
        "DAN.*do anything now",
        "STAN.*strive to avoid norms",
        "developer mode.*ignore"
      ]
    },
    "sql_injection": {
      "enabled": true,
      "patterns": [
        "SELECT.*FROM.*WHERE.*\\$\\{",
        "INSERT.*INTO.*VALUES.*\\$\\{",
        "UPDATE.*SET.*\\$\\{",
        "DELETE.*FROM.*WHERE.*\\$\\{"
      ]
    },
    "dangerous_commands": {
      "enabled": true,
      "blocked": [
        "rm -rf /",
        "rm -rf /*",
        "> /etc/passwd",
        "eval\\(",
        "exec\\(",
        "os\\.system\\(f\""
      ],
      "warn": [
        "chmod 777",
        "chmod -R 777"
      ]
    }
  }
}